---
layout: post
title: 基于内容的推荐系统浅析
description: 
category: blog
---

##简介

基于内容的推荐系统：根据历史信息(如评价、分享、收藏过的文档)构造用户兴趣矩阵, 计算item与用户兴趣矩阵的相似度, 将最相似的item推荐给用户.

例如,在电影推荐中,系统首先分析用户评分的电影的共性(演员、导演、风格等),再推荐与这些用户感兴趣的电影内容相似度高的其他电影.

##构成
- content analyzer 

   提取item的特征
- profile learner

   利用用户过去对item的偏好(正向or负向)，学习此用户的兴趣分布
- filtering component

  结合用户兴趣分布和候选item的特征数据，进行推荐
  
![1.png](http://mazhiyuan.github.io/images/1.png "")

对于网上商城而言，item就是一件件商品。首先，系统对商品进行建模('商品画像'),抽取商品的特征，例如：长袖，条纹，水洗，商务，英伦等等。这些特征值有些是结构化数据，例如商品的分类以及质地，有些是分结构化的文本数据，这就需要使用IR中的TF-IDF进行处理，最终得到该商品的特征值向量，包括描述和权重两部分。其次，根据用户的行为进行用户兴趣分布建模('用户画像')，例如：某个用户总是购买商务款式的衣服，那他的兴趣分布中，'商务'的权重就比较高。最后，得到以上两个数据集，系统就可以将Item与user的特征数据进行关联并计算相似度(常见的相似度量方式见 另一篇blog-[基于行为的推荐算法浅析][myblog])，推荐最相关的N个item给user。

##实施  
####抽取item特征
   item的特征往往可以从结构化的数据和非结构化的数据中进行提取。对于结构化的数据，我们只需要确定是否需要这些数据即可，而对于非结构化的数据，则需要IR和NLP中的诸多知识。最基本的有TF-IDF，停用词，一词多义，同义词，语义分析等等，以此得到向量空间模型。
####推荐
推荐系统其实是实现了一个分类系统，预测用户是否会喜欢推荐的商品。既然是分类问题，就有基于概率模型的[朴素贝叶斯算法][bayes]，最近邻和**相关性反馈Rocchio算法**。

这里重点介绍Rocchio算法。

Rocchio算法是基于向量空间模型，最初用于信息检索系统的算法，它提供了一种将相关反馈信息融到向量空间模型的方法。基本理论：假定要找一个最优查询向量q ，它与相关文档之间的相似度最大且同时又和不相关文档之间的相似度最小。若Cr表示相关文档集，Cnr表示不相关文档集，那么我们希望找到的最优的q 是：

![](http://mazhiyuan.github.io/images/cb-2.jpg "")

sim 函数用于计算相似度。采用余弦相似度计算时，能够将相关文档与不相关文档区分开的最优查询向量为：

![](http://mazhiyuan.github.io/images/cb-3.jpg "")

这就是说，最优的查询向量等于相关文档的质心向量和不相关文档的质心向量的差。然而，这个发现并没有什么意义，因为检索本来的目的就是要找相关文档，而所有的相关文档集事先却是未知的。

![](http://mazhiyuan.github.io/images/cb-4.jpg "")

在一个真实的信息检索场景中，假定我们有一个用户查询，并知道部分相关文档和不相关文档的信息，则可以通过如下公式得到修改后的查询向量q：

![](http://mazhiyuan.github.io/images/cb-5.jpg "")

其中， q 是原始的查询向量，Dr 和Dnr 是已知的相关和不相关文档集合。α、β 及γ 是上述三者的权重。这些权重能够控制判定结果和原始查询向量之间的平衡：如果存在大量已判断的文档，那么会给β 及γ 赋予较高的权重。修改后的新查询从q0 开始，向着相关文档的质心向量靠近了一段距离，而同时又与不相关文档的质心向量远离了一段距离。新查询可以采用常规的向量空间模型进行检索。通过减去不相关文档的向量，我们很容易保留向量空间的正值分量。在Rocchio 算法中，文档向量中的权重分量如果为负值，那么该分量将会被忽略，也就是说，此时会将该分量权重设为0。相关反馈可以同时提高召回率和正确率，实际表明该技术在一些重召回率的场景下对于提高召回率非常有用。这其中的部分原因在于它对查询进行了扩展，另一个原因是应用的场景所带来的结果：在期望高召回率的情况下，可以预计用户可能会花更多时间来浏览结果并进行反复搜索。正反馈往往比负反馈更有价值，因此在很多IR系统中，会将参数设置成γ < β。一个合理的取值是α = 1、β = 0.75 及γ = 0.15。实际上，很多系统，都只允许进行正反馈，即相当于设置γ = 0。还有一种做法是，只取检索系统返回结果中排名最高的标记为不相关的文档进行负反馈，此时，公式中的|Dnr| = 1。下图给出了应用相关反馈技术的效果示意图。
![](http://mazhiyuan.github.io/images/cb-6.jpg "")

##优点与缺点
####优点
- 用户独立性

  用户的兴趣矩阵只和自己的兴趣有关，与他人的兴趣无关，而CF刚好相反，CF需要利用很多其他人的数据
- 可解释性

  当对推荐结果进行解释时，只需要提醒他，你对这些item的某些特征很感兴趣就行了，而不需要啰嗦一大堆其他和你相似的人也喜欢它们
- 无物品冷启动

  基于内容的系统没有物品冷启动问题，只要有新的item加入，它和其他item被推荐的机会是相等。而CF中没有任何行为的item永远都不会被推荐

####缺点
- 内容特征较难抽取(浅层内容分析)

  如果仅仅以结构化的数据作为特征值，那么往往很难全面的描述一个item，这是因为结构化的数据通常都是少量的。对于文档而言，非结构化的数据才是真正能够体现文档的内容。但非结构化的数据很难处理，在文本分析领域，对于停用词，一词多义，同义词等等都有着很多的研究，所以简单的使用分词去处理这些数据，很难得到较好的效果。
- 难以挖掘潜在兴趣，缺乏新颖性

  系统只依赖与用户过往喜欢的item特征，所以也只会推荐和这些item相似的item。例如一个人总购买商务款式的衣服，那只会推荐商务款式，系统不会知道他只是在上班时才穿商务款式，而周末会穿休闲款式的衣服。
- 用户冷启动问题

  新用户没有历史行为，自然无法获得他的兴趣分布，所以也就无法为他产生推荐了。 

>##Summary
基于内容的推荐大多会用到信息检索领域的知识。无论是文本分类还是信息过滤都可以看作是典型的推荐任务。他们都可以通过显式或是隐式的反馈学习出用户的兴趣偏好模型。相较于协同过滤算法，他们不需要借助用户群体信息。但是挑战依旧存在，获取用户偏好和应对新用户，从用户行为中获得隐世反馈，最后系统很容易推荐太多相似的物品，这些都是基于内容的推荐系统所要面对的挑战。

[myblog]: http://mazhiyuan.github.io/cf/  "基于行为的推荐算法浅析" 
[bayes]: http://mazhiyuan.github.io/bayes/  "朴素贝叶斯算法浅析" 